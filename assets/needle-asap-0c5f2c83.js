import{n as g}from"./index-3534b4f4.js";function r(){return typeof globalThis.Needle=="object"}function h(t){switch(t){case"immersive-ar":return{optionalFeatures:["anchors","local-floor","hand-tracking","layers","dom-overlay","hit-test"]};case"immersive-vr":return{optionalFeatures:["local-floor","bounded-floor","hand-tracking","high-fixed-foveation-level","layers"]};default:return console.warn("No default session init for mode",t),{}}}let u=!1;function y(t){var n;if(u||(u=!0,!t.debug))return;const e=document.createElement("div");if(e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.zIndex="1000",e.style.gap="10px",e.style.display="flex",t.debug&&document.body.appendChild(e),"xr"in navigator){if(e.appendChild(document.createTextNode("needle asap: handleSessionGranted")),/WebXRViewer\//i.test(navigator.userAgent)){console.warn("WebXRViewer does not support addEventListener");return}const o=async function(){var l,d;if((l=navigator.xr)==null||l.removeEventListener("sessiongranted",o),r()){e.appendChild(document.createTextNode("needle asap: Engine has already loaded"));return}if(globalThis["needle:XRSession"]!=null){e.appendChild(document.createTextNode("needle asap: Session already requested"));return}console.log("needle asap: Session granted"),e.appendChild(document.createTextNode("Session granted"));const p=h("immersive-vr"),s=(d=navigator.xr)==null?void 0:d.requestSession("immersive-vr",p);globalThis["needle:XRSession"]=s==null?void 0:s.catch(c=>(console.error("needle asap: Session request failed",c),e.appendChild(document.createTextNode("Session request failed: "+c.message)),null))};(n=navigator.xr)==null||n.addEventListener("sessiongranted",o,{once:!0})}}const m=new URLSearchParams(location.search),i=m.get("debugasap")!=null;i&&console.log("Needle asap is here!");let a=null;f();y({debug:i});function f(t=0){if(a=document.querySelector("needle-engine"),!a)return setTimeout(f,50+t*10);x(a);const e=globalThis["needle:codegen_files"];if(Array.isArray(e))for(const n of e)v(n)}function v(t){i&&console.log("prefetch",t);const e=document.createElement("link");e.rel="prefetch",e.href=t,document.head.appendChild(e)}function x(t){if(r())return;const e=document.createElement("img"),n=t==null?void 0:t.getAttribute("loading-logo-src");n&&(n==null?void 0:n.length)>0?e.src=n:e.src=g,e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.zIndex="-10",e.style.pointerEvents="none",e.style.width="33px",e.style.height="auto",e.style.filter="grayscale(100%)",e.style.opacity="0",e.style.textShadow="0 0 10px 0px rgba(0,0,0,.5)",t.appendChild(e),e.animate([{opacity:0},{opacity:.5},{opacity:0}],{duration:3e3,iterations:1/0});const o=setInterval(()=>{r()&&(clearInterval(o),e.remove())},10)}
